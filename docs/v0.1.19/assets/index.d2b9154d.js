import{v as e,i as T,B as b,l as E,A as g,I as y,S as K,d as x,D as P,y as S,M as j,a as L,b as q,c as F,G as J,e as C,T as Q,H as U,f as k,C as X,g as B,h as z,j as Y,k as _,m as Z,n as ee,_ as H,r as te,o as R,p as M,q as ne,s as oe,t as N,u as re,w as ae,R as $,E as se,x as le,z as ie,Q as ce,F as ue,V as de,J as D,K as me,L as fe,X as pe,N as he}from"./vendor.aa547d55.js";const ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerpolicy&&(s.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?s.credentials="include":l.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(l){if(l.ep)return;l.ep=!0;const s=o(l);fetch(l.href,s)}};ge();const ve=({mode:n,value:t,setValue:o,theme:a})=>e(b,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden"},e(T,{defaultLanguage:n,theme:a,options:{minimap:{enabled:!1}},onChange:o,value:t,width:"100%",height:"70vh"})),be=(n,t)=>{const[o,a]=E(n);return S(()=>{let l=n.concat([]);n.forEach(s=>{s.type==="option"&&s.suboptions&&t&&Object.keys(t).forEach(r=>{const d=t[r];d&&s?.suboptions?.[d]&&(l=l.concat(s.suboptions[d]))})}),a(l)},[t,a,n]),[o]},we=({hashkey:n,options:t})=>{const[o,a]=E(!1),l=g(()=>{a(!o)},[o]);return e(x,null,e(y,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e(K,null),size:"md",onClick:l}),e(ye,{hashkey:n,isOpen:o,setOpen:a,options:t}))},ye=({hashkey:n,isOpen:t,setOpen:o,options:a})=>{const[l,s]=P(n||"options",Object.fromEntries(a.filter(c=>c.default).map(c=>[c.name,c.default]))),[r,d]=E(l||{}),[w]=be(a,r),[O,h]=E(void 0),W=g(c=>{const{name:f,value:i}=c.target;let m=a.concat([]);a.forEach(A=>{A.suboptions&&Object.values(A.suboptions).forEach(G=>m=m.concat(G))});const v=m.find(A=>A.name===f);if(!v){console.error(`No option found for name=${f}`);return}v.type==="boolean"?d({...r,[f]:i==="1"}):d({...r,[f]:i})},[r,d,a]),V=g(()=>{o(!t)},[o,t]),I=g(()=>{const c={};if(Object.keys(r).forEach(i=>{const m=a.find(v=>v.name===i);if(m&&m.validator&&m.type!=="boolean"){const v=m.validator(r[i]);v&&(c[i]=v)}}),Object.keys(c).length>0){h(c);return}h(void 0);const f={};Object.keys(r).forEach(i=>{const m=w.find(v=>v.name===i);r[i]!==void 0&&(m!==void 0?m.map?f[i]=m.map(r[i]):m.type==="boolean"?f[i]=r[i]===!0||r[i]==="1"||r[i]==="true":m.type==="number"?f[i]=typeof r[i]=="string"?parseFloat(r[i]):r[i]:f[i]=r[i]:f[i]=r[i])}),o(!t),s(f)},[o,t,a,r,w,s,h]);return S(()=>{if(!t)return;const c=f=>{f.key==="Enter"&&t&&I()};return window.addEventListener("keyup",c),()=>{window.removeEventListener("keyup",c)}},[I,t]),e(z,{placement:"top",onClose:I,isOpen:t},e(j,null,e(L,null,e(q,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(F,null,e(b,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(J,{templateColumns:"repeat(12, 1fr)",gap:6},w.map(c=>e(x,null,e(C,{rowSpan:1,colSpan:4},e(b,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e(Q,{textAlign:"right",verticalAlign:"bottom"},c.displayName||c.name,":"))),e(C,{rowSpan:1,colSpan:8}," ",Se(c,r[c.name],W)))),e(C,{rowSpan:1,colSpan:12}),e(C,{rowSpan:1,colSpan:12}),e(C,{rowSpan:1,colSpan:12}),e(C,{rowSpan:1,colSpan:12},e(U,{spacing:2,direction:"row"},e(k,null),e(y,{size:"lg",color:"red",icon:e(X,null),onClick:V}),e(y,{size:"lg",color:"green",icon:e(B,null),onClick:I})))))))))},Se=(n,t,o)=>{switch(n.type){case"option":return e(Z,{name:n.name,value:t,onChange:o,placeholder:"Select option"},n.options.map(a=>e("option",{value:a},a)));case"boolean":return e(_,{name:n.name,rightIcon:e(B,null),onChange:o,isChecked:t===!0||t==="1",value:t?0:1});default:return e(b,{w:"100%",h:"10"},e(Y,{name:n.name,type:"text",placeholder:"",value:t===void 0?n.default:t,onInput:o}))}};var u;(function(n){n[n.Start=0]="Start",n[n.Editing=1]="Editing",n[n.Running=2]="Running",n[n.Finished=3]="Finished"})(u||(u={}));const p=ee(n=>({code:void 0,result:void 0,mode:0,setCode:t=>n(o=>({code:t})),setResult:t=>n(o=>({result:t})),setMode:t=>n(o=>({mode:t}))})),Ce=()=>{const n=p(a=>a.mode),t=p(a=>a.result),[o]=H("presentation");return u.Running===n?e(te.BeatLoader,{size:8,color:"blue"}):!t||o?null:t.failure?e(x,null,e(R,{status:"error"},e(M,null),e(oe,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(R,{status:"error"},e(M,null),e(ne,null,`${t.failure?.error}`))):e(R,{status:"success"},e(M,null))},Ee=Object.getPrototypeOf(async function(){}).constructor,xe=(n,t)=>{let o=null,a=Object.keys(t);try{o=Ee("exports",`"use strict"; return (async function(${a.join(", ")}){${n}})`)({})}catch(s){return Promise.resolve({failure:{error:s,phase:"compile"}})}if(o){var l="exec";let s=Object.values(t);return o.apply?o.apply(null,s).then(r=>({result:r})).catch(r=>({failure:{error:r,phase:l}})):o.then(r=>r.apply(null,s)).then(r=>({result:r})).catch(r=>({failure:{error:r,phase:l}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},Ie=()=>{const n=N(),t=p(s=>s.setMode),o=p(s=>s.setResult),a=p(s=>s.result);return S(()=>()=>{if(a?.result&&typeof a?.result=="function")try{a.result()}catch(s){console.error("Failed to cancel without error:",s)}},[a]),[g(async s=>{if(!s||s.trim().length===0){t(u.Finished),o(void 0);return}if(!!n.metaframe){o(void 0);try{const r=await xe(s,{metaframe:n.metaframe,BABYLON:re,HASHTOOLS:ae});o(r)}catch(r){console.error(r),o({failure:{error:r}})}t(u.Finished)}},[n.metaframe,t,o]),a]},Ae=()=>{const n=N(),t=p(d=>d.mode),o=p(d=>d.setMode),a=p(d=>d.code),[l,s]=$("text",void 0),r=g(()=>{switch(t){case u.Editing:l!==a&&s(a),o(u.Running);break;case u.Finished:o(u.Editing);break;case u.Running:o(u.Editing);break;case u.Start:break}},[n.metaframe,a,l,s,t,o]);return e(y,{verticalAlign:"top","aria-label":"Help",colorScheme:t===u.Editing?"blue":void 0,icon:t===u.Editing?e(B,null):e(se,null),size:"md",onClick:r,mr:"4"})},Oe=({url:n})=>{const[t,o]=E(!(le()||ie()[1].text!==void 0));n=n||`${window.location.origin}${window.location.pathname}/README.md`;const a=g(()=>{o(!t)},[t]);return e(x,null,e(y,{verticalAlign:"top","aria-label":"Help",icon:e(ce,null),size:"md",onClick:a,mr:"4"}),e(Be,{url:n,isOpen:t,setOpen:o}))},Be=({isOpen:n,setOpen:t,url:o})=>{console.log("isOpen",n);const a=g(()=>{t(!n)},[t,n]),l=g(()=>{t(!1)},[t]),s=`https://metapages.github.io/metaframe-markdown/#?url=${o}`;return e(z,{size:"full",placement:"top",onClose:a,isOpen:n,onOverlayClick:l},e(j,null,e(L,null,e(ue,{size:"lg",bg:"gray.100"}),e(F,null,e("iframe",{width:"100%",height:"100%",src:s})))))},He=()=>{const[n,t]=H("presentation",void 0),o=g(()=>{t(!n),window.location.reload()},[n,t]);return e(x,null,e(y,{verticalAlign:"top","aria-label":"Help",icon:e(de,null),size:"md",onClick:o,mr:"4"}))},Re=[{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]},{name:"menuAtBottom",displayName:"Place menu bar at bottom of render content",default:!1,type:"boolean"}],Me=()=>{const[n]=P("options",{theme:"light",menuAtBottom:!1}),[t]=H("presentation"),o=p(h=>h.code),a=p(h=>h.setCode),l=p(h=>h.mode),s=p(h=>h.setMode),[r]=Ie(),[d]=$("text",void 0);S(()=>{l===u.Start&&s(u.Running)},[l,s]),S(()=>{l===u.Running&&r&&r(o)},[l,o,r]),S(()=>{a(d),r&&r(d)},[d,a,r]);const w=e("canvas",{width:document.body.clientWidth,height:document.body.clientHeight,id:"renderCanvas"});if(t)return w;const O=e(D,{spacing:2,alignItems:"flex-start"},e(me,{width:"100%"},e(Ae,null),e(k,null),e(He,null),e(Oe,null),e(we,{options:Re})),e(Ce,null));return e(b,{w:"100%",p:2},e(D,{spacing:2,alignItems:"flex-start"},n?.menuAtBottom?null:e(b,{w:"100%"},O),l===u.Editing?e(b,{w:"100%"},e(ve,{mode:"javascript",theme:n?.theme||"light",setValue:a,value:o})):o&&o.length>0?w:null,n?.menuAtBottom?e(b,{w:"100%"},O):null))},Pe=()=>e(Me,null);fe(e(he,null,e(pe,null,e(Pe,null))),document.getElementById("root"));
//# sourceMappingURL=index.d2b9154d.js.map
