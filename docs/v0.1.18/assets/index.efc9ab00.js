import{v as e,i as G,l as C,A as v,I as E,S as K,d as O,_ as L,y,M,D as P,a as q,b as B,B as w,G as J,c as S,T as Q,H as U,e as F,C as Y,f as A,g as k,h as _,j as X,k as Z,m as ee,n as N,r as te,o as H,p as R,q as ne,s as re,t as z,u as oe,w as ae,x as W,E as se,Q as le,z as ie,V as $,F as ce,J as ue,K as de,L as fe}from"./vendor.c5d5e6f7.js";const me=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerpolicy&&(s.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?s.credentials="include":l.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(l){if(l.ep)return;l.ep=!0;const s=r(l);fetch(l.href,s)}};me();const pe=({mode:n,value:t,setValue:r,theme:a})=>e(G,{defaultLanguage:n,theme:a,options:{minimap:{enabled:!1}},onChange:r,value:t,width:"100%",height:"70vh"}),he=(n,t)=>{const[r,a]=C(n);return y(()=>{let l=n.concat([]);n.forEach(s=>{s.type==="option"&&s.suboptions&&t&&Object.keys(t).forEach(o=>{const d=t[o];d&&s?.suboptions?.[d]&&(l=l.concat(s.suboptions[d]))})}),a(l)},[t,a,n]),[r]},ge=({hashkey:n,options:t})=>{const[r,a]=C(!1),l=v(()=>{a(!r)},[r]);return e(O,null,e(E,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e(K,null),size:"md",onClick:l}),e(ve,{hashkey:n,isOpen:r,setOpen:a,options:t}))},ve=({hashkey:n,isOpen:t,setOpen:r,options:a})=>{const[l,s]=L(n||"options",Object.fromEntries(a.filter(c=>c.default).map(c=>[c.name,c.default]))),[o,d]=C(l||{}),[b]=he(a,o),[j,h]=C(void 0),D=v(c=>{const{name:m,value:i}=c.target;let f=a.concat([]);a.forEach(x=>{x.suboptions&&Object.values(x.suboptions).forEach(V=>f=f.concat(V))});const g=f.find(x=>x.name===m);if(!g){console.error(`No option found for name=${m}`);return}g.type==="boolean"?d({...o,[m]:i==="1"}):d({...o,[m]:i})},[o,d,a]),T=v(()=>{r(!t)},[r,t]),I=v(()=>{const c={};if(Object.keys(o).forEach(i=>{const f=a.find(g=>g.name===i);if(f&&f.validator&&f.type!=="boolean"){const g=f.validator(o[i]);g&&(c[i]=g)}}),Object.keys(c).length>0){h(c);return}h(void 0);const m={};Object.keys(o).forEach(i=>{const f=b.find(g=>g.name===i);o[i]!==void 0&&(f!==void 0?f.map?m[i]=f.map(o[i]):f.type==="boolean"?m[i]=o[i]===!0||o[i]==="1"||o[i]==="true":f.type==="number"?m[i]=typeof o[i]=="string"?parseFloat(o[i]):o[i]:m[i]=o[i]:m[i]=o[i])}),r(!t),s(m)},[r,t,a,o,b,s,h]);return y(()=>{if(!t)return;const c=m=>{m.key==="Enter"&&t&&I()};return window.addEventListener("keyup",c),()=>{window.removeEventListener("keyup",c)}},[I,t]),e(k,{placement:"top",onClose:I,isOpen:t},e(M,null,e(P,null,e(q,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(B,null,e(w,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(J,{templateColumns:"repeat(12, 1fr)",gap:6},b.map(c=>e(O,null,e(S,{rowSpan:1,colSpan:4},e(w,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e(Q,{textAlign:"right",verticalAlign:"bottom"},c.displayName||c.name,":"))),e(S,{rowSpan:1,colSpan:8}," ",be(c,o[c.name],D)))),e(S,{rowSpan:1,colSpan:12}),e(S,{rowSpan:1,colSpan:12}),e(S,{rowSpan:1,colSpan:12}),e(S,{rowSpan:1,colSpan:12},e(U,{spacing:2,direction:"row"},e(F,null),e(E,{size:"lg",color:"red",icon:e(Y,null),onClick:T}),e(E,{size:"lg",color:"green",icon:e(A,null),onClick:I})))))))))},be=(n,t,r)=>{switch(n.type){case"option":return e(Z,{name:n.name,value:t,onChange:r,placeholder:"Select option"},n.options.map(a=>e("option",{value:a},a)));case"boolean":return e(X,{name:n.name,rightIcon:e(A,null),onChange:r,isChecked:t===!0||t==="1",value:t?0:1});default:return e(w,{w:"100%",h:"10"},e(_,{name:n.name,type:"text",placeholder:"",value:t===void 0?n.default:t,onInput:r}))}};var u;(function(n){n[n.Start=0]="Start",n[n.Editing=1]="Editing",n[n.Running=2]="Running",n[n.Finished=3]="Finished"})(u||(u={}));const p=ee(n=>({code:void 0,result:void 0,mode:0,setCode:t=>n(r=>({code:t})),setResult:t=>n(r=>({result:t})),setMode:t=>n(r=>({mode:t}))})),ye=()=>{const n=p(a=>a.mode),t=p(a=>a.result),[r]=N("presentation");return u.Running===n?e(te.BeatLoader,{size:8,color:"blue"}):!t||r?null:t.failure?e(O,null,e(H,{status:"error"},e(R,null),e(re,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(H,{status:"error"},e(R,null),e(ne,null,`${t.failure?.error}`))):e(H,{status:"success"},e(R,null))},we=Object.getPrototypeOf(async function(){}).constructor,Se=(n,t)=>{let r=null,a=Object.keys(t);try{r=we("exports",`"use strict"; return (async function(${a.join(", ")}){${n}})`)({})}catch(s){return Promise.resolve({failure:{error:s,phase:"compile"}})}if(r){var l="exec";let s=Object.values(t);return r.apply?r.apply(null,s).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:l}})):r.then(o=>o.apply(null,s)).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:l}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},Ce=()=>{const n=z(),t=p(s=>s.setMode),r=p(s=>s.setResult),a=p(s=>s.result);return y(()=>()=>{if(a?.result&&typeof a?.result=="function")try{a.result()}catch(s){console.error("Failed to cancel without error:",s)}},[a]),[v(async s=>{if(!s||s.trim().length===0){t(u.Finished),r(void 0);return}if(!!n.metaframe){r(void 0);try{const o=await Se(s,{metaframe:n.metaframe,BABYLON:oe,HASHTOOLS:ae});r(o)}catch(o){console.error(o),r({failure:{error:o}})}t(u.Finished)}},[n.metaframe,t,r]),a]},Ee=()=>{const n=z(),t=p(d=>d.mode),r=p(d=>d.setMode),a=p(d=>d.code),[l,s]=W("text",void 0),o=v(()=>{switch(t){case u.Editing:l!==a&&s(a),r(u.Running);break;case u.Finished:r(u.Editing);break;case u.Running:r(u.Editing);break;case u.Start:break}},[n.metaframe,a,l,s,t,r]);return e(E,{verticalAlign:"top","aria-label":"Help",colorScheme:t===u.Editing?"blue":void 0,icon:t===u.Editing?e(A,null):e(se,null),size:"md",onClick:o,mr:"4"})},Ie=({url:n})=>{const[t,r]=C(!1);n=n||`${window.location.origin}${window.location.pathname}/README.md`;const a=v(()=>{r(!t)},[t]);return e(O,null,e(E,{verticalAlign:"top","aria-label":"Help",icon:e(le,null),size:"md",onClick:a,mr:"2"}),e(xe,{url:n,isOpen:t,setOpen:r}))},xe=({isOpen:n,setOpen:t,url:r})=>{const a=v(()=>{t(!n)},[t,n]),l=v(()=>{t(!1)},[t]),s=`https://metapages.github.io/metaframe-markdown/#?url=${r}`;return e(k,{size:"full",placement:"top",onClose:a,isOpen:n,onOverlayClick:l},e(M,null,e(P,null,e(ie,{size:"lg",bg:"gray.100"}),e(B,null,e("iframe",{width:"100%",height:"100%",src:s})))))},Oe=[{name:"canvasWidth",displayName:"Canvas width",default:300,type:"number"},{name:"canvasHeight",displayName:"Canvas height",default:100,type:"number"},{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]},{name:"stretch",displayName:"Stretch to fill container",default:!1,type:"boolean"}],Ae=()=>{const[n]=L("options",{canvasWidth:300,canvasHeight:100,theme:"light",stretch:!1}),[t]=N("presentation"),r=p(h=>h.code),a=p(h=>h.setCode),l=p(h=>h.mode),s=p(h=>h.setMode),[o]=Ce(),[d]=W("text",void 0);y(()=>{l===u.Start&&s(u.Running)},[l,s]),y(()=>{l===u.Running&&o&&o(r)},[l,r,o]),y(()=>{a(d),o&&o(d)},[d,a,o]);const b=e("canvas",{style:n?.stretch?{width:"100%",minWidth:n?.canvasWidth||300}:void 0,width:n?.canvasWidth||300,height:n?.canvasHeight||100,id:"renderCanvas"});if(t)return b;const j=e($,{spacing:2,alignItems:"flex-start"},e(ce,{width:"100%"},e(Ee,null),e(F,null),e(Ie,null),e(ge,{options:Oe})),e(ye,null));return e(w,{w:"100%",p:2},e($,{spacing:2,alignItems:"flex-start"},l===u.Editing?e(w,{w:"100%"},e(pe,{mode:"javascript",theme:n?.theme||"light",setValue:a,value:r})):r&&r.length>0?b:null,e(w,{w:"30%"},j)))},He=()=>e(Ae,null);ue(e(fe,null,e(de,null,e(He,null))),document.getElementById("root"));
//# sourceMappingURL=index.efc9ab00.js.map
